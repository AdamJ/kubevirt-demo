<!doctype html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1, shrink-to-fit=no" />
    <meta name="go-import" content="kubevirt.io/kubevirt git https://github.com/kubevirt/kubevirt">
    <meta name="go-import" content="kubevirt.io/containerized-data-importer git https://github.com/kubevirt/containerized-data-importer">
    <meta name="description" content="Virtual Machine Management on Kubernetes
">
    <title>Interfaces and Networks</title>

    <link rel="apple-touch-icon" sizes="72x72" href="/assets/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon/favicon-16x16.png">
    <link rel="manifest" href="/assets/favicon/site.webmanifest">
    <link rel="mask-icon" href="/assets/favicon/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#00aba9">
    <meta name="theme-color" content="#ffffff">

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css" integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4" crossorigin="anonymous">
    <link rel="stylesheet" href="/css/main.css">
    <link rel="canonical" href="https://www.kubevirt.io//docs/workloads/vms/interfaces-networks.html">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700" rel="stylesheet">
</head>


  <body>
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top" role="navigation">
        <a class="navbar-brand" href="/">
    <img src="/assets/images/KubeVirt_logo_color.svg" class="navbar-brand-image d-inline-block align-top" alt="KubeVirt.io">
  </a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
    <i class="fas fa-th-large"></i>
  </button>
  <div class="collapse navbar-collapse" id="navbarSupportedContent">
    <ul class="navbar-nav">
      

      
        <li  class="nav-item" >
          <a class="nav-link text-uppercase" href="/blogs/">Blogs</a>
        </li>
      
        <li  class="nav-item" >
          <a class="nav-link text-uppercase" href="/videos/">Videos</a>
        </li>
      
        <li  class="nav-item active" >
          <a class="nav-link text-uppercase" href="/docs/">Docs</a>
        </li>
      
        <li  class="nav-item" >
          <a class="nav-link text-uppercase" href="/community/">Community</a>
        </li>
      

    </ul>
  </div>

    </nav>

    <main role="main" style="margin-top: 60px;">
      <div class="container-fluid">
        <div class="row">
          <h1 class="page-title offset-lg-1">Docs</h1>
        </div>
        <div class="row">
          <div class="col-sm-12 col-md-4 col-lg-3 offset-lg-1">
            <!-- <div class="search-bar">
              <form action="/search.html" method="get">
                <label for="search-box">Search</label>
                <input type="text" id="search-box" name="query">
                <input type="submit" value="search">
              </form>
            </div> -->
            
  
    <h3 class="docs-title">
      <a href="/docs"  class="docs-title--item" >Introduction</a>
    </h3>
    
  
    <h3 class="docs-title">
      <a href="/docs/installation.html"  class="docs-title--item" >Installation</a>
    </h3>
    
    <ul class="docs-navigation">
      
        <li class="docs-navigation--item">
          <a href="/docs/installation/admission-controllers.html"  class="docs-navigation--item_link" >
            Admission Controllers
          </a>
          
        </li>
      
        <li class="docs-navigation--item">
          <a href="/docs/installation/feature-matrix.html"  class="docs-navigation--item_link" >
            Feature Matrix
          </a>
          
        </li>
      
    </ul>
    
  
    <h3 class="docs-title">
      <a href="/docs/usage.html"  class="docs-title--item" >Usage</a>
    </h3>
    
  
    <h3 class="docs-title">
      <a href="/docs/authorization.html"  class="docs-title--item" >Authorization</a>
    </h3>
    
  
    <h3 class="docs-title">
      <a href="/docs/workloads.html"  class="docs-title--item" >Workloads</a>
    </h3>
    
    <ul class="docs-navigation">
      
        <li class="docs-navigation--item">
          <a href="/docs/workloads/virtual-machines.html"  class="docs-navigation--item_link" >
            Virtual Machines
          </a>
          
            <ul class="docs-navigation_sub">
            
                <li class="docs-navigation_sub--item">
                  <a href="/docs/workloads/vms/creation.html"  class="docs-navigation_sub--item_link" >
                    Creation
                  </a>
                </li>
            
                <li class="docs-navigation_sub--item">
                  <a href="/docs/workloads/vms/node-eviction.html"  class="docs-navigation_sub--item_link" >
                    Node Eviction
                  </a>
                </li>
            
                <li class="docs-navigation_sub--item">
                  <a href="/docs/workloads/vms/presets.html"  class="docs-navigation_sub--item_link" >
                    Presets
                  </a>
                </li>
            
                <li class="docs-navigation_sub--item">
                  <a href="/docs/workloads/vms/life-cycle.html"  class="docs-navigation_sub--item_link" >
                    Life-cycle
                  </a>
                </li>
            
                <li class="docs-navigation_sub--item">
                  <a href="/docs/workloads/vms/dns-for-services.html"  class="docs-navigation_sub--item_link" >
                    DNS for Services and VirtualMachineInstances
                  </a>
                </li>
            
                <li class="docs-navigation_sub--item">
                  <a href="/docs/workloads/vms/expose-vm-services.html"  class="docs-navigation_sub--item_link" >
                    Expose VirtualMachineInstances as Services
                  </a>
                </li>
            
                <li class="docs-navigation_sub--item">
                  <a href="/docs/workloads/vms/create-networkpolicy.html"  class="docs-navigation_sub--item_link" >
                    Create Networkpolicy
                  </a>
                </li>
            
                <li class="docs-navigation_sub--item">
                  <a href="/docs/workloads/vms/graphical-and-console-access.html"  class="docs-navigation_sub--item_link" >
                    Graphical and Console Access
                  </a>
                </li>
            
                <li class="docs-navigation_sub--item">
                  <a href="/docs/workloads/vms/disks-and-volumes.html"  class="docs-navigation_sub--item_link" >
                    Disks and Volumes
                  </a>
                </li>
            
                <li class="docs-navigation_sub--item">
                  <a href="/docs/workloads/vms/interfaces-networks.html"  class="docs-navigation_sub--item_link active" >
                    Interfaces and Networks
                  </a>
                </li>
            
                <li class="docs-navigation_sub--item">
                  <a href="/docs/workloads/vms/startup-scripts.html"  class="docs-navigation_sub--item_link" >
                    Startup Scripts
                  </a>
                </li>
            
                <li class="docs-navigation_sub--item">
                  <a href="/docs/workloads/vms/guest-os-info.html"  class="docs-navigation_sub--item_link" >
                    Guest Operating System Information
                  </a>
                </li>
            
                <li class="docs-navigation_sub--item">
                  <a href="/docs/workloads/vms/virtual-hardware-config.html"  class="docs-navigation_sub--item_link" >
                    Virtualized Hardware Configuration
                  </a>
                </li>
            
                <li class="docs-navigation_sub--item">
                  <a href="/docs/workloads/vms/vms-to-nodes.html"  class="docs-navigation_sub--item_link" >
                    Assigning VMs to Nodes
                  </a>
                </li>
            
            </ul>
          
        </li>
      
        <li class="docs-navigation--item">
          <a href="/docs/workloads/controllers.html"  class="docs-navigation--item_link" >
            Controllers
          </a>
          
            <ul class="docs-navigation_sub">
            
                <li class="docs-navigation_sub--item">
                  <a href="/docs/workloads/controllers/virtualmachine.html"  class="docs-navigation_sub--item_link" >
                    VirtualMachine
                  </a>
                </li>
            
                <li class="docs-navigation_sub--item">
                  <a href="/docs/workloads/controllers/virtual-machine-replica-set.html"  class="docs-navigation_sub--item_link" >
                    VirtualMachineInstanceReplicaSet
                  </a>
                </li>
            
            </ul>
          
        </li>
      
        <li class="docs-navigation--item">
          <a href="/docs/workloads/templates.html"  class="docs-navigation--item_link" >
            Templates
          </a>
          
        </li>
      
        <li class="docs-navigation--item">
          <a href="/docs/workloads/annotations-labels.html"  class="docs-navigation--item_link" >
            Annotations and Labels
          </a>
          
        </li>
      
    </ul>
    
  
    <h3 class="docs-title">
      <a href="/docs/additional-resources.html"  class="docs-title--item" >Additional Resources</a>
    </h3>
    
  


          </div>
          <div class="col-sm-12 col-md-8 col-lg-8 docs">
            <h1 id="interfaces-and-networks">Interfaces and Networks</h1>

<p>Connecting a virtual machine to a network consists of two parts. First,
networks are specified in <code class="highlighter-rouge">spec.networks</code>. Then, interfaces backed by the
networks are added to the VM by specifying them in
<code class="highlighter-rouge">spec.domain.devices.interfaces</code>.</p>

<p>Each interface must have a corresponding network with the same name.</p>

<p>An <code class="highlighter-rouge">interface</code> defines a virtual network interface of a virtual machine (also
called a frontend). A <code class="highlighter-rouge">network</code> specifies the backend of an <code class="highlighter-rouge">interface</code> and
declares which logical or physical device it is connected to (also called as
backend).</p>

<p>There are multiple ways of configuring an <code class="highlighter-rouge">interface</code> as well as a <code class="highlighter-rouge">network</code>.</p>

<p>All possible configuration options are available in the
<a href="https://kubevirt.io/api-reference/master/definitions.html#_v1_interface">Interface API Reference</a>
and <a href="https://kubevirt.io/api-reference/master/definitions.html#_v1_network">Network API Reference</a>.</p>

<blockquote>
  <p><strong>Note:</strong> Currently, the only supported network type is <code class="highlighter-rouge">pod</code>.</p>
</blockquote>

<h2 id="backend">Backend</h2>

<p>Network backends are configured in <code class="highlighter-rouge">spec.networks</code>. A network must have a
unique name. Additional fields declare which logical or physical device the
network relates to.</p>

<p>A <code class="highlighter-rouge">pod</code> network represents the default pod <code class="highlighter-rouge">eth0</code> interface configured by
cluster SDN solution that is present in each pod.</p>

<blockquote>
  <p><strong>Note:</strong> Currently, the only supported network type is <code class="highlighter-rouge">pod</code>. In the future,
more network types may be supported.</p>
</blockquote>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">kind</span><span class="pi">:</span> <span class="s">VM</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">domain</span><span class="pi">:</span>
    <span class="na">devices</span><span class="pi">:</span>
      <span class="na">interfaces</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">red</span>
          <span class="na">macAddress</span><span class="pi">:</span> <span class="s">de:ad:00:00:be:af</span>
          <span class="na">model</span><span class="pi">:</span> <span class="s">e1000</span>
          <span class="na">bridge</span><span class="pi">:</span> <span class="pi">{}</span>
  <span class="na">networks</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">red</span>
    <span class="na">pod</span><span class="pi">:</span> <span class="pi">{}</span> <span class="c1"># Stock pod network</span>
</code></pre></div></div>

<h2 id="frontend">Frontend</h2>

<p>Network interfaces are configured in <code class="highlighter-rouge">spec.domain.devices.interfaces</code>. They
describe properties of virtual interfaces as “seen” inside guest instances. The
same network backend may be connected to a virtual machine in multiple
different ways, each with their own connectivity guarantees and
characteristics.</p>

<p>Each interface should declare its type by defining on of the following fields:</p>

<table>
  <thead>
    <tr>
      <th>Type</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">bridge</code></td>
      <td>Connect using a linux bridge</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">slirp</code></td>
      <td>Connect using QEMU user networking mode</td>
    </tr>
  </tbody>
</table>

<p>Each interface may also have additional configuration fields that modify
properties “seen” inside guest instances, as listed below:</p>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Format</th>
      <th>Default value</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">model</code></td>
      <td>One of: <code class="highlighter-rouge">e1000</code>, <code class="highlighter-rouge">e1000e</code>, <code class="highlighter-rouge">ne2k_pci</code>, <code class="highlighter-rouge">pcnet</code>, <code class="highlighter-rouge">rtl8139</code>, <code class="highlighter-rouge">virtio</code></td>
      <td><code class="highlighter-rouge">virtio</code></td>
      <td>NIC type</td>
    </tr>
    <tr>
      <td>macAddress</td>
      <td><code class="highlighter-rouge">ff:ff:ff:ff:ff:ff</code> or <code class="highlighter-rouge">FF-FF-FF-FF-FF-FF</code></td>
      <td> </td>
      <td>MAC address as seen inside the guest system, for example: <code class="highlighter-rouge">de:ad:00:00:be:af</code></td>
    </tr>
    <tr>
      <td>ports</td>
      <td> </td>
      <td>empty</td>
      <td>List of ports to be forwarded to the virtual machine.</td>
    </tr>
  </tbody>
</table>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">kind</span><span class="pi">:</span> <span class="s">VM</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">domain</span><span class="pi">:</span>
    <span class="na">devices</span><span class="pi">:</span>
      <span class="na">interfaces</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">red</span>
          <span class="na">model</span><span class="pi">:</span> <span class="s">e1000</span> <span class="c1"># expose e1000 NIC to the guest</span>
          <span class="na">bridge</span><span class="pi">:</span> <span class="pi">{}</span> <span class="c1"># connect through a bridge</span>
          <span class="na">ports</span><span class="pi">:</span>
           <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">http</span>
             <span class="na">port</span><span class="pi">:</span> <span class="s">80</span>
  <span class="na">networks</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">red</span>
    <span class="na">pod</span><span class="pi">:</span> <span class="pi">{}</span>
</code></pre></div></div>

<h3 id="ports">Ports</h3>

<p>Declare ports listen by the virtual machine</p>

<blockquote>
  <p><strong>Note:</strong> When using the slirp interface only the configured ports will be forwarded to the virtual machine.</p>
</blockquote>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Format</th>
      <th>Required</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="highlighter-rouge">name</code></td>
      <td> </td>
      <td>no</td>
      <td>Name</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">port</code></td>
      <td>1 - 65535</td>
      <td>yes</td>
      <td>Port to expose</td>
    </tr>
    <tr>
      <td><code class="highlighter-rouge">protocol</code></td>
      <td>TCP,UDP</td>
      <td>no</td>
      <td>Connection protocol</td>
    </tr>
  </tbody>
</table>

<blockquote>
  <p><strong>Tip:</strong> Use <code class="highlighter-rouge">e1000</code> model if your guest image doesn’t ship with virtio
drivers.</p>
</blockquote>

<p>If <code class="highlighter-rouge">spec.domain.devices.interfaces</code> is omitted, the virtual machine is
connected using the default pod network interface of <code class="highlighter-rouge">bridge</code> type. If you’d
like to have a virtual machine instance without any network connectivity, you
can use the <code class="highlighter-rouge">autoattachPodInterface</code> field as follows:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">kind</span><span class="pi">:</span> <span class="s">VM</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">domain</span><span class="pi">:</span>
    <span class="na">devices</span><span class="pi">:</span>
      <span class="na">autoattachPodInterface</span><span class="pi">:</span> <span class="no">false</span>
</code></pre></div></div>

<h3 id="bridge">bridge</h3>

<p>In <code class="highlighter-rouge">bridge</code> mode, virtual machines are connected to the network backend through
a linux “bridge”. The pod network IPv4 address is delegated to the virtual
machine via DHCPv4. The virtual machine should be configured to use DHCP to
acquire IPv4 addresses.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">kind</span><span class="pi">:</span> <span class="s">VM</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">domain</span><span class="pi">:</span>
    <span class="na">devices</span><span class="pi">:</span>
      <span class="na">interfaces</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">red</span>
          <span class="na">bridge</span><span class="pi">:</span> <span class="pi">{}</span> <span class="c1"># connect through a bridge</span>
  <span class="na">networks</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">red</span>
    <span class="na">pod</span><span class="pi">:</span> <span class="pi">{}</span>
</code></pre></div></div>

<p>At this time, <code class="highlighter-rouge">bridge</code> mode doesn’t support additional configuration
fields.</p>

<blockquote>
  <p><strong>Note:</strong> due to IPv4 address delagation, in <code class="highlighter-rouge">bridge</code> mode the pod doesn’t
have an IP address configured, which may introduce issues with third-party
solutions that may rely on it. For example, Istio may not work in this mode.</p>
</blockquote>

<h3 id="slirp">slirp</h3>

<p>In <code class="highlighter-rouge">slirp</code> mode, virtual machines are connected to the network backend using
QEMU user networking mode. In this mode, QEMU allocates internal IP addresses
to virtual machines and hides them behind NAT.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">kind</span><span class="pi">:</span> <span class="s">VM</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">domain</span><span class="pi">:</span>
    <span class="na">devices</span><span class="pi">:</span>
      <span class="na">interfaces</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">red</span>
          <span class="na">slirp</span><span class="pi">:</span> <span class="pi">{}</span> <span class="c1"># connect using SLIRP mode</span>
  <span class="na">networks</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">red</span>
    <span class="na">pod</span><span class="pi">:</span> <span class="pi">{}</span>
</code></pre></div></div>

<p>At this time, <code class="highlighter-rouge">slirp</code> mode doesn’t support additional configuration fields.</p>

<blockquote>
  <p><strong>Note:</strong> in <code class="highlighter-rouge">slirp</code> mode, the only supported protocols are TCP and UDP. ICMP
is <em>not</em> supported.</p>
</blockquote>

<p>More information about SLIRP mode can be found in
<a href="https://wiki.qemu.org/Documentation/Networking#User_Networking_.28SLIRP.29">QEMU Wiki</a>.</p>

          </div>
        </div>
      </div>
    </main>

    <footer class="footer" role="footer">
      <div class="container-fluid">
  <div class="row justify-content-center">
    <div class="col-sm-12 col-md-5">
      <p class="privacy-statement text-sm-left" style="text-align: center;">
        &copy; <script type="text/javascript"> document.write(new Date().getFullYear()); </script> KubeVirt | <a href="/privacy" class="privacy-statement-link">Privacy Statement</a>
      </p>
    </div>
    <div class="col-sm-12 col-md-5" style="text-align: center;">
      <p class="text-md-right">
        <a href="https://twitter.com/kubevirt" aria-label="Visit us on Twitter" class="link-social-twitter">
          <i class="fab fa-twitter fa-lg"></i>
        </a>
        <a href="https://github.com/kubevirt" aria-label="View our repo on GitHub" class="link-social-github">
          <i class="fab fa-github fa-lg"></i>
        </a>
        <a href="https://groups.google.com/forum/#!forum/kubevirt-dev" aria-label="Send us an email" class="link-social-mail">
          <i class="fas fa-envelope fa-lg"></i>
        </a>
        <a href="https://calendar.google.com/calendar/embed?src=18pc0jur01k8f2cccvn5j04j1g%40group.calendar.google.com&ctz=Etc%2FGMT"
            aria-label="See our calendar"
            class="link-social-calendar">
          <i class="fas fa-calendar fa-lg"></i>
        </a>
      </p>
    </div>
  </div>
  <div class="row">
    <div class="col offset-md-1 text-sm-left footer-licensing" style="text-align: center;">
      Code licensed under <a href="https://github.com/kubevirt/kubevirt/blob/master/LICENSE">Apache 2.0</a>,
      site under <a href="https://github.com/kubevirt/kubevirt.github.io/blob/master/LICENSE">MIT</a>.
    </div>
  </div>
</div>

    </footer>

    <script defer src="https://use.fontawesome.com/releases/v5.1.0/js/all.js" integrity="sha384-3LK/3kTpDE/Pkp8gTNp2gR/2gOiwQ6QaO7Td0zV76UFJVhqLl4Vl3KL1We6q6wR9" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"></script>
    <script id="dsq-count-scr" src="//kubevirt-io.disqus.com/count.js" async></script>
    <script src="/js/kubevirt-io.js"></script>
  </body>
</html>
