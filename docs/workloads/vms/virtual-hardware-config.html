<!doctype html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1, shrink-to-fit=no" />
    <meta name="go-import" content="kubevirt.io/kubevirt git https://github.com/kubevirt/kubevirt">
    <meta name="go-import" content="kubevirt.io/containerized-data-importer git https://github.com/kubevirt/containerized-data-importer">
    <meta name="description" content="Virtual Machine Management on Kubernetes
">
    <title>Virtualized Hardware Configuration</title>

    <link rel="apple-touch-icon" sizes="72x72" href="/assets/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon/favicon-16x16.png">
    <link rel="manifest" href="/assets/favicon/site.webmanifest">
    <link rel="mask-icon" href="/assets/favicon/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#00aba9">
    <meta name="theme-color" content="#ffffff">

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css" integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4" crossorigin="anonymous">
    <link rel="stylesheet" href="/css/main.css">
    <link rel="canonical" href="https://www.kubevirt.io//docs/workloads/vms/virtual-hardware-config.html">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700" rel="stylesheet">
</head>


  <body>
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top" role="navigation">
        <a class="navbar-brand" href="/">
    <img src="/assets/images/KubeVirt_logo_color.svg" class="navbar-brand-image d-inline-block align-top" alt="KubeVirt.io">
  </a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
    <i class="fas fa-th-large"></i>
  </button>
  <div class="collapse navbar-collapse" id="navbarSupportedContent">
    <ul class="navbar-nav">
      

      
        <li  class="nav-item" >
          <a class="nav-link text-uppercase" href="/blogs/">Blogs</a>
        </li>
      
        <li  class="nav-item" >
          <a class="nav-link text-uppercase" href="/videos/">Videos</a>
        </li>
      
        <li  class="nav-item active" >
          <a class="nav-link text-uppercase" href="/docs/">Docs</a>
        </li>
      
        <li  class="nav-item" >
          <a class="nav-link text-uppercase" href="/community/">Community</a>
        </li>
      

    </ul>
  </div>

    </nav>

    <main role="main" style="margin-top: 60px;">
      <div class="container-fluid">
        <div class="row">
          <h1 class="page-title offset-lg-1">Docs</h1>
        </div>
        <div class="row">
          <div class="col-sm-12 col-md-4 col-lg-3 offset-lg-1">
            <!-- <div class="search-bar">
              <form action="/search.html" method="get">
                <label for="search-box">Search</label>
                <input type="text" id="search-box" name="query">
                <input type="submit" value="search">
              </form>
            </div> -->
            
  
    <h3 class="docs-title">
      <a href="/docs"  class="docs-title--item" >Introduction</a>
    </h3>
    
  
    <h3 class="docs-title">
      <a href="/docs/installation.html"  class="docs-title--item" >Installation</a>
    </h3>
    
    <ul class="docs-navigation">
      
        <li class="docs-navigation--item">
          <a href="/docs/installation/admission-controllers.html"  class="docs-navigation--item_link" >
            Admission Controllers
          </a>
          
        </li>
      
        <li class="docs-navigation--item">
          <a href="/docs/installation/feature-matrix.html"  class="docs-navigation--item_link" >
            Feature Matrix
          </a>
          
        </li>
      
    </ul>
    
  
    <h3 class="docs-title">
      <a href="/docs/usage.html"  class="docs-title--item" >Usage</a>
    </h3>
    
  
    <h3 class="docs-title">
      <a href="/docs/authorization.html"  class="docs-title--item" >Authorization</a>
    </h3>
    
  
    <h3 class="docs-title">
      <a href="/docs/workloads.html"  class="docs-title--item" >Workloads</a>
    </h3>
    
    <ul class="docs-navigation">
      
        <li class="docs-navigation--item">
          <a href="/docs/workloads/virtual-machines.html"  class="docs-navigation--item_link" >
            Virtual Machines
          </a>
          
            <ul class="docs-navigation_sub">
            
                <li class="docs-navigation_sub--item">
                  <a href="/docs/workloads/vms/creation.html"  class="docs-navigation_sub--item_link" >
                    Creation
                  </a>
                </li>
            
                <li class="docs-navigation_sub--item">
                  <a href="/docs/workloads/vms/node-eviction.html"  class="docs-navigation_sub--item_link" >
                    Node Eviction
                  </a>
                </li>
            
                <li class="docs-navigation_sub--item">
                  <a href="/docs/workloads/vms/presets.html"  class="docs-navigation_sub--item_link" >
                    Presets
                  </a>
                </li>
            
                <li class="docs-navigation_sub--item">
                  <a href="/docs/workloads/vms/life-cycle.html"  class="docs-navigation_sub--item_link" >
                    Life-cycle
                  </a>
                </li>
            
                <li class="docs-navigation_sub--item">
                  <a href="/docs/workloads/vms/dns-for-services.html"  class="docs-navigation_sub--item_link" >
                    DNS for Services and VirtualMachineInstances
                  </a>
                </li>
            
                <li class="docs-navigation_sub--item">
                  <a href="/docs/workloads/vms/expose-vm-services.html"  class="docs-navigation_sub--item_link" >
                    Expose VirtualMachineInstances as Services
                  </a>
                </li>
            
                <li class="docs-navigation_sub--item">
                  <a href="/docs/workloads/vms/create-networkpolicy.html"  class="docs-navigation_sub--item_link" >
                    Create Networkpolicy
                  </a>
                </li>
            
                <li class="docs-navigation_sub--item">
                  <a href="/docs/workloads/vms/graphical-and-console-access.html"  class="docs-navigation_sub--item_link" >
                    Graphical and Console Access
                  </a>
                </li>
            
                <li class="docs-navigation_sub--item">
                  <a href="/docs/workloads/vms/disks-and-volumes.html"  class="docs-navigation_sub--item_link" >
                    Disks and Volumes
                  </a>
                </li>
            
                <li class="docs-navigation_sub--item">
                  <a href="/docs/workloads/vms/interfaces-networks.html"  class="docs-navigation_sub--item_link" >
                    Interfaces and Networks
                  </a>
                </li>
            
                <li class="docs-navigation_sub--item">
                  <a href="/docs/workloads/vms/startup-scripts.html"  class="docs-navigation_sub--item_link" >
                    Startup Scripts
                  </a>
                </li>
            
                <li class="docs-navigation_sub--item">
                  <a href="/docs/workloads/vms/guest-os-info.html"  class="docs-navigation_sub--item_link" >
                    Guest Operating System Information
                  </a>
                </li>
            
                <li class="docs-navigation_sub--item">
                  <a href="/docs/workloads/vms/virtual-hardware-config.html"  class="docs-navigation_sub--item_link active" >
                    Virtualized Hardware Configuration
                  </a>
                </li>
            
                <li class="docs-navigation_sub--item">
                  <a href="/docs/workloads/vms/vms-to-nodes.html"  class="docs-navigation_sub--item_link" >
                    Assigning VMs to Nodes
                  </a>
                </li>
            
            </ul>
          
        </li>
      
        <li class="docs-navigation--item">
          <a href="/docs/workloads/controllers.html"  class="docs-navigation--item_link" >
            Controllers
          </a>
          
            <ul class="docs-navigation_sub">
            
                <li class="docs-navigation_sub--item">
                  <a href="/docs/workloads/controllers/virtualmachine.html"  class="docs-navigation_sub--item_link" >
                    VirtualMachine
                  </a>
                </li>
            
                <li class="docs-navigation_sub--item">
                  <a href="/docs/workloads/controllers/virtual-machine-replica-set.html"  class="docs-navigation_sub--item_link" >
                    VirtualMachineInstanceReplicaSet
                  </a>
                </li>
            
            </ul>
          
        </li>
      
        <li class="docs-navigation--item">
          <a href="/docs/workloads/templates.html"  class="docs-navigation--item_link" >
            Templates
          </a>
          
        </li>
      
        <li class="docs-navigation--item">
          <a href="/docs/workloads/annotations-labels.html"  class="docs-navigation--item_link" >
            Annotations and Labels
          </a>
          
        </li>
      
    </ul>
    
  
    <h3 class="docs-title">
      <a href="/docs/additional-resources.html"  class="docs-title--item" >Additional Resources</a>
    </h3>
    
  


          </div>
          <div class="col-sm-12 col-md-8 col-lg-8 docs">
            <h1 id="virtualized-hardware-configuration">Virtualized Hardware Configuration</h1>

<p>Fine-tuning different aspects of the hardware which are not device related (BIOS, mainboard, …) is sometimes necessary to allow guest operating systems to properly boot and reboot.</p>

<h2 id="machine-type">Machine Type</h2>

<p>QEMU is able to work with two different classes of chipsets for x86_64, so called machine types. The x86_64 chipsets are i440fx (also called pc) and q35. They are versioned based on qemu-system-$ARCH, following the format <code class="highlighter-rouge">pc-${machine_type}-${qemu_version}</code>, e.g. <code class="highlighter-rouge">pc-i440fx-2.10</code> and <code class="highlighter-rouge">pc-q35-2.10</code>.</p>

<p>KubeVirt defaults to QEMU’s newest q35 machine type. If a custom machine type is desired, it is configurable through the following structure:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">myvmi</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">domain</span><span class="pi">:</span>
    <span class="na">machine</span><span class="pi">:</span>
      <span class="c1"># This value indicates QEMU machine type.</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">pc-q35-2.10</span>
    <span class="na">resources</span><span class="pi">:</span>
      <span class="na">requests</span><span class="pi">:</span>
        <span class="na">memory</span><span class="pi">:</span> <span class="s">512M</span>
    <span class="na">devices</span><span class="pi">:</span>
      <span class="na">disks</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">myimage</span>
        <span class="na">volumeName</span><span class="pi">:</span> <span class="s">myimage</span>
        <span class="na">disk</span><span class="pi">:</span> <span class="pi">{}</span>
  <span class="na">volumes</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">myimage</span>
      <span class="na">persistentVolumeClaim</span><span class="pi">:</span>
        <span class="na">claimName</span><span class="pi">:</span> <span class="s">myclaim</span>
</code></pre></div></div>

<p>Comparison of the machine types’ internals can be found <a href="https://wiki.qemu.org/Features/Q35">at QEMU wiki</a>.</p>

<h2 id="biosuefi">BIOS/UEFI</h2>

<p>All virtual machines currently use BIOS for booting. UEFI/OVMF is not yet supported.</p>

<h2 id="smbios-firmware">SMBIOS Firmware</h2>

<p>In order to provide a consistent view on the virtualized hardware for the guest OS, the SMBIOS UUID can be set to a constant value via <code class="highlighter-rouge">spec.firmware.uuid</code>:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">myvmi</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">domain</span><span class="pi">:</span>
    <span class="na">firmware</span><span class="pi">:</span>
      <span class="c1"># this sets the UUID</span>
      <span class="na">uuid</span><span class="pi">:</span> <span class="s">5d307ca9-b3ef-428c-8861-06e72d69f223</span>
    <span class="na">resources</span><span class="pi">:</span>
      <span class="na">requests</span><span class="pi">:</span>
        <span class="na">memory</span><span class="pi">:</span> <span class="s">512M</span>
    <span class="na">devices</span><span class="pi">:</span>
      <span class="na">disks</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">myimage</span>
        <span class="na">volumeName</span><span class="pi">:</span> <span class="s">myimage</span>
        <span class="na">disk</span><span class="pi">:</span> <span class="pi">{}</span>
  <span class="na">volumes</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">myimage</span>
      <span class="na">persistentVolumeClaim</span><span class="pi">:</span>
        <span class="na">claimName</span><span class="pi">:</span> <span class="s">myclaim</span>
</code></pre></div></div>

<h2 id="cpu">CPU</h2>

<p><strong>Note</strong>: This is not related to scheduling decisions or resource assignment.</p>

<h3 id="topology">Topology</h3>

<p>Setting the number of CPU cores is possible via <code class="highlighter-rouge">spec.domain.cpu.cores</code>. The following VM will have a CPU with <code class="highlighter-rouge">3</code> cores:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">myvmi</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">domain</span><span class="pi">:</span>
    <span class="na">cpu</span><span class="pi">:</span>
      <span class="c1"># this sets the cores</span>
      <span class="na">cores</span><span class="pi">:</span> <span class="s">3</span>
    <span class="na">resources</span><span class="pi">:</span>
      <span class="na">requests</span><span class="pi">:</span>
        <span class="na">memory</span><span class="pi">:</span> <span class="s">512M</span>
    <span class="na">devices</span><span class="pi">:</span>
      <span class="na">disks</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">myimage</span>
        <span class="na">volumeName</span><span class="pi">:</span> <span class="s">myimage</span>
        <span class="na">disk</span><span class="pi">:</span> <span class="pi">{}</span>
  <span class="na">volumes</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">myimage</span>
      <span class="na">persistentVolumeClaim</span><span class="pi">:</span>
        <span class="na">claimName</span><span class="pi">:</span> <span class="s">myclaim</span>
</code></pre></div></div>

<h3 id="model">Model</h3>

<p><strong>Note</strong>: Be sure that node CPU model where you run a VM, has the same or higher CPU family.</p>

<p><strong>Note</strong>: If CPU model wasn’t defined, the VM will have CPU model closest to one that used on the node where the VM is running.</p>

<p>Setting the CPU model is possible via <code class="highlighter-rouge">spec.domain.cpu.model</code>. The following VM will have a CPU with the <code class="highlighter-rouge">Conroe</code> model:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">myvmi</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">domain</span><span class="pi">:</span>
    <span class="na">cpu</span><span class="pi">:</span>
      <span class="c1"># this sets the CPU model</span>
      <span class="na">model</span><span class="pi">:</span> <span class="s">Conroe</span>
<span class="nn">...</span>
</code></pre></div></div>

<p>You can check list of available models <a href="https://github.com/libvirt/libvirt/blob/master/src/cpu/cpu_map.xml">here</a>.</p>

<h4 id="cpu-model-special-cases">CPU model special cases</h4>

<p>As special cases you can set <code class="highlighter-rouge">spec.domain.cpu.model</code> equals to:</p>
<ul>
  <li><code class="highlighter-rouge">host-passthrough</code> to passthrough CPU from the node to the VM
    <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">metadata</span><span class="pi">:</span>
<span class="na">name</span><span class="pi">:</span> <span class="s">myvmi</span>
<span class="na">spec</span><span class="pi">:</span>
<span class="na">domain</span><span class="pi">:</span>
  <span class="na">cpu</span><span class="pi">:</span>
    <span class="c1"># this passthrough the node CPU to the VM</span>
    <span class="na">model</span><span class="pi">:</span> <span class="s">host-passthrough</span>
<span class="nn">...</span>
</code></pre></div>    </div>
  </li>
  <li><code class="highlighter-rouge">host-model</code> to get CPU on the VM close to the node one
    <div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">metadata</span><span class="pi">:</span>
<span class="na">name</span><span class="pi">:</span> <span class="s">myvmi</span>
<span class="na">spec</span><span class="pi">:</span>
<span class="na">domain</span><span class="pi">:</span>
  <span class="na">cpu</span><span class="pi">:</span>
    <span class="c1"># this set the VM CPU close to the node one</span>
    <span class="na">model</span><span class="pi">:</span> <span class="s">host-model</span>
<span class="nn">...</span>
</code></pre></div>    </div>
  </li>
</ul>

<p>See the <a href="https://libvirt.org/formatdomain.html#elementsCPU">CPU API reference</a> for more details.</p>

<h2 id="clock">Clock</h2>

<h3 id="guest-time">Guest time</h3>

<p>Sets the virtualized hardware clock inside the VM to a specific time. Available options are</p>

<ul>
  <li><strong>utc</strong></li>
  <li><strong>timezone</strong></li>
</ul>

<p>See the <a href="https://kubevirt.github.io/api-reference/master/definitions.html#_v1_clock">Clock API Reference</a> for all possible configuration options.</p>

<h4 id="utc">utc</h4>

<p>If <code class="highlighter-rouge">utc</code> is specified, the VM’s clock will be set to UTC.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">myvmi</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">domain</span><span class="pi">:</span>
    <span class="na">clock</span><span class="pi">:</span>
      <span class="na">utc</span><span class="pi">:</span> <span class="pi">{}</span>
    <span class="na">resources</span><span class="pi">:</span>
      <span class="na">requests</span><span class="pi">:</span>
        <span class="na">memory</span><span class="pi">:</span> <span class="s">512M</span>
    <span class="na">devices</span><span class="pi">:</span>
      <span class="na">disks</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">myimage</span>
        <span class="na">volumeName</span><span class="pi">:</span> <span class="s">myimage</span>
        <span class="na">disk</span><span class="pi">:</span> <span class="pi">{}</span>
  <span class="na">volumes</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">myimage</span>
      <span class="na">persistentVolumeClaim</span><span class="pi">:</span>
        <span class="na">claimName</span><span class="pi">:</span> <span class="s">myclaim</span>
</code></pre></div></div>

<h4 id="timezone">timezone</h4>

<p>If <code class="highlighter-rouge">timezone</code> is specified, the VM’s clock will be set to the specified local time.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">myvmi</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">domain</span><span class="pi">:</span>
    <span class="na">clock</span><span class="pi">:</span>
      <span class="na">timezone</span><span class="pi">:</span> <span class="s2">"</span><span class="s">America/New</span><span class="nv"> </span><span class="s">York"</span>
    <span class="na">resources</span><span class="pi">:</span>
      <span class="na">requests</span><span class="pi">:</span>
        <span class="na">memory</span><span class="pi">:</span> <span class="s">512M</span>
    <span class="na">devices</span><span class="pi">:</span>
      <span class="na">disks</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">myimage</span>
        <span class="na">volumeName</span><span class="pi">:</span> <span class="s">myimage</span>
        <span class="na">disk</span><span class="pi">:</span> <span class="pi">{}</span>
  <span class="na">volumes</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">myimage</span>
      <span class="na">persistentVolumeClaim</span><span class="pi">:</span>
        <span class="na">claimName</span><span class="pi">:</span> <span class="s">myclaim</span>
</code></pre></div></div>

<h3 id="timers">Timers</h3>

<ul>
  <li><strong>pit</strong></li>
  <li><strong>rtc</strong></li>
  <li><strong>kvm</strong></li>
  <li><strong>hyperv</strong></li>
</ul>

<p>A pretty common timer configuration for VMs looks like this:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">myvmi</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">domain</span><span class="pi">:</span>
    <span class="na">clock</span><span class="pi">:</span>
      <span class="na">utc</span><span class="pi">:</span> <span class="pi">{}</span>
      <span class="c1"># here are the timer</span>
      <span class="na">timer</span><span class="pi">:</span>
        <span class="na">hpet</span><span class="pi">:</span>
          <span class="na">present</span><span class="pi">:</span> <span class="no">false</span>
        <span class="na">pit</span><span class="pi">:</span>
          <span class="na">tickPolicy</span><span class="pi">:</span> <span class="s">delay</span>
        <span class="na">rtc</span><span class="pi">:</span>
          <span class="na">tickPolicy</span><span class="pi">:</span> <span class="s">catchup</span>
        <span class="na">hyperv</span><span class="pi">:</span> <span class="pi">{}</span>
    <span class="na">resources</span><span class="pi">:</span>
      <span class="na">requests</span><span class="pi">:</span>
        <span class="na">memory</span><span class="pi">:</span> <span class="s">512M</span>
    <span class="na">devices</span><span class="pi">:</span>
      <span class="na">disks</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">myimage</span>
        <span class="na">volumeName</span><span class="pi">:</span> <span class="s">myimage</span>
        <span class="na">disk</span><span class="pi">:</span> <span class="pi">{}</span>
  <span class="na">volumes</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">myimage</span>
      <span class="na">persistentVolumeClaim</span><span class="pi">:</span>
        <span class="na">claimName</span><span class="pi">:</span> <span class="s">myclaim</span>
</code></pre></div></div>

<p><code class="highlighter-rouge">hpet</code> is disabled,<code class="highlighter-rouge">pit</code> and <code class="highlighter-rouge">rtc</code> are configured to use a specific <code class="highlighter-rouge">tickPolicy</code>. Finally, <code class="highlighter-rouge">hyperv</code> is made available too.</p>

<p>See the <a href="https://kubevirt.github.io/api-reference/master/definitions.html#_v1_timer">Timer API Reference</a> for all possible configuration options.</p>

<p><strong>Note</strong>: Timer can be part of a machine type. Thus it may be necessary to explicitly disable them. We may in the future decide to add them via cluster-level defaulting, if they are part of a QEMU machine definition.</p>

<h2 id="video-and-graphics-device">Video and Graphics Device</h2>

<p>By default a minimal Video and Graphics device configuration will be applied to
the VirtualMachineInstance. The video device is <code class="highlighter-rouge">vga</code> compatible and comes with
a memory size of 16 MB. These devices allow connecting to the OS via <code class="highlighter-rouge">vnc</code>.</p>

<p>It is possible not attach these devices by setting
<code class="highlighter-rouge">spec.domain.devices.autoattachGraphicsDevice</code> to <code class="highlighter-rouge">false</code>:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">myvmi</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">domain</span><span class="pi">:</span>
    <span class="na">devices</span><span class="pi">:</span>
      <span class="na">autoattachGraphicsDevice</span><span class="pi">:</span> <span class="no">false</span>
      <span class="na">disks</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">myimage</span>
        <span class="na">volumeName</span><span class="pi">:</span> <span class="s">myimage</span>
        <span class="na">disk</span><span class="pi">:</span> <span class="pi">{}</span>
  <span class="na">volumes</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">myimage</span>
      <span class="na">persistentVolumeClaim</span><span class="pi">:</span>
        <span class="na">claimName</span><span class="pi">:</span> <span class="s">myclaim</span>
</code></pre></div></div>

<p>Such VMIs are very often referenced as <code class="highlighter-rouge">headless</code> VMIs.</p>

<p>If using a huge amount of small VMs this can be helpful to increase the VMI
density per node, since no memory needs to be reserved for video.</p>

<h2 id="features">Features</h2>

<p>KubeVirt supports a range of virtualization features which may be tweaked in order to allow non-Linux based operating systems to properly boot. Most noteworthy are</p>

<ul>
  <li><strong>acpi</strong></li>
  <li><strong>apic</strong></li>
  <li><strong>hyperv</strong></li>
</ul>

<p>A common feature configuration is shown by the following example:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">kubevirt.io/v1alpha2</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">VirtualMachineInstance</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">myvmi</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">domain</span><span class="pi">:</span>
    <span class="c1"># typical features</span>
    <span class="na">features</span><span class="pi">:</span>
      <span class="na">acpi</span><span class="pi">:</span> <span class="pi">{}</span>
      <span class="na">apic</span><span class="pi">:</span> <span class="pi">{}</span>
      <span class="na">hyperv</span><span class="pi">:</span>
        <span class="na">relaxed</span><span class="pi">:</span> <span class="pi">{}</span>
        <span class="na">vapic</span><span class="pi">:</span> <span class="pi">{}</span>
        <span class="na">spinlocks</span><span class="pi">:</span>
          <span class="na">spinlocks</span><span class="pi">:</span> <span class="s">8191</span>
    <span class="na">resources</span><span class="pi">:</span>
      <span class="na">requests</span><span class="pi">:</span>
        <span class="na">memory</span><span class="pi">:</span> <span class="s">512M</span>
    <span class="na">devices</span><span class="pi">:</span>
      <span class="na">disks</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">myimage</span>
        <span class="na">volumeName</span><span class="pi">:</span> <span class="s">myimage</span>
        <span class="na">disk</span><span class="pi">:</span> <span class="pi">{}</span>
  <span class="na">volumes</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">myimage</span>
      <span class="na">persistentVolumeClaim</span><span class="pi">:</span>
        <span class="na">claimname</span><span class="pi">:</span> <span class="s">myclaim</span>
</code></pre></div></div>

<p>See the <a href="https://kubevirt.github.io/api-reference/master/definitions.html#_v1_features">Features API Reference</a> for all available features and configuration options.</p>

<h2 id="resources-requests-and-limits">Resources Requests and Limits</h2>

<p>An optional resource request can be specified by the users to allow the scheduler to make a better decision in finding the most suitable Node to place the VM.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">kubevirt.io/v1alpha2</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">VirtualMachineInstance</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">myvmi</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">domain</span><span class="pi">:</span>
    <span class="na">resources</span><span class="pi">:</span>
      <span class="na">requests</span><span class="pi">:</span>
        <span class="na">memory</span><span class="pi">:</span> <span class="s2">"</span><span class="s">1Gi"</span>
        <span class="na">cpu</span><span class="pi">:</span> <span class="s2">"</span><span class="s">2"</span>
      <span class="na">limits</span><span class="pi">:</span>
        <span class="na">memory</span><span class="pi">:</span> <span class="s2">"</span><span class="s">2Gi"</span>
        <span class="na">cpu</span><span class="pi">:</span> <span class="s2">"</span><span class="s">1"</span>
      <span class="na">disks</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">myimage</span>
        <span class="na">volumeName</span><span class="pi">:</span> <span class="s">myimage</span>
        <span class="na">disk</span><span class="pi">:</span> <span class="pi">{}</span>
  <span class="na">volumes</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">myimage</span>
      <span class="na">persistentVolumeClaim</span><span class="pi">:</span>
        <span class="na">claimname</span><span class="pi">:</span> <span class="s">myclaim</span>
</code></pre></div></div>

<h4 id="cpu-1">CPU</h4>

<p>Specifying CPU limits will determine the amount of <em>cpu</em> <em>shares</em> set on the control group the VM is running in, in other words, the amount of time the VM’s CPUs can execute on the assigned resources when there is a competition for CPU resources.</p>

<p>For more information please refer to <a href="https://kubernetes.io/docs/concepts/configuration/manage-compute-resources-container/#how-pods-with-resource-limits-are-run">how Pods with resource limits are run</a>.</p>

<h4 id="memory-overhead">Memory Overhead</h4>

<p>Various VM resources, such as a video adapter, IOThreads, and supplementary system software, consume additional memory from the Node, beyond the requested memory intended for the guest OS consumption. In order to provide a better estimate for the scheduler, this memory overhead will be calculated and added to the requested memory.</p>

<p>Please see <a href="https://kubernetes.io/docs/concepts/configuration/manage-compute-resources-container/#how-pods-with-resource-requests-are-scheduled">how Pods with resource requests are scheduled</a> for additional information on resource requests and limits.</p>

<h2 id="hugepages">Hugepages</h2>

<p>KubeVirt give you possibility to use hugepages as backing memory for your VM. You will need to provide desired amount of memory <code class="highlighter-rouge">resources.requests.memory</code> and size of hugepages to use <code class="highlighter-rouge">memory.hugepages.pageSize</code>, for example for x86_64 architecture it can be <code class="highlighter-rouge">2Mi</code>.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">apiVersion</span><span class="pi">:</span> <span class="s">kubevirt.io/v1alpha1</span>
<span class="na">kind</span><span class="pi">:</span> <span class="s">VirtualMachine</span>
<span class="na">metadata</span><span class="pi">:</span>
  <span class="na">name</span><span class="pi">:</span> <span class="s">myvm</span>
<span class="na">spec</span><span class="pi">:</span>
  <span class="na">domain</span><span class="pi">:</span>
    <span class="na">resources</span><span class="pi">:</span>
      <span class="na">requests</span><span class="pi">:</span>
        <span class="na">memory</span><span class="pi">:</span> <span class="s2">"</span><span class="s">64Mi"</span>
    <span class="na">memory</span><span class="pi">:</span>
      <span class="na">hugepages</span><span class="pi">:</span>
        <span class="na">pageSize</span><span class="pi">:</span> <span class="s2">"</span><span class="s">2Mi"</span>
    <span class="na">disks</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">myimage</span>
      <span class="na">volumeName</span><span class="pi">:</span> <span class="s">myimage</span>
      <span class="na">disk</span><span class="pi">:</span> <span class="pi">{}</span>
  <span class="na">volumes</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">myimage</span>
      <span class="na">persistentVolumeClaim</span><span class="pi">:</span>
        <span class="na">claimname</span><span class="pi">:</span> <span class="s">myclaim</span>
</code></pre></div></div>

<p>In the above example the VM will have <code class="highlighter-rouge">64Mi</code> of memory, but instead of regular memory it will use node hugepages of the size of <code class="highlighter-rouge">2Mi</code>.</p>

<h4 id="limitations">Limitations</h4>

<ul>
  <li>a node must have pre-allocated hugepages</li>
  <li>hugepages size cannot be bigger than requested memory</li>
  <li>requested memory must be divisible by hugepages size</li>
</ul>

          </div>
        </div>
      </div>
    </main>

    <footer class="footer" role="footer">
      <div class="container-fluid">
  <div class="row justify-content-center">
    <div class="col-sm-12 col-md-5">
      <p class="privacy-statement text-sm-left" style="text-align: center;">
        &copy; <script type="text/javascript"> document.write(new Date().getFullYear()); </script> KubeVirt | <a href="/privacy" class="privacy-statement-link">Privacy Statement</a>
      </p>
    </div>
    <div class="col-sm-12 col-md-5" style="text-align: center;">
      <p class="text-md-right">
        <a href="https://twitter.com/kubevirt" aria-label="Visit us on Twitter" class="link-social-twitter">
          <i class="fab fa-twitter fa-lg"></i>
        </a>
        <a href="https://github.com/kubevirt" aria-label="View our repo on GitHub" class="link-social-github">
          <i class="fab fa-github fa-lg"></i>
        </a>
        <a href="https://groups.google.com/forum/#!forum/kubevirt-dev" aria-label="Send us an email" class="link-social-mail">
          <i class="fas fa-envelope fa-lg"></i>
        </a>
        <a href="https://calendar.google.com/calendar/embed?src=18pc0jur01k8f2cccvn5j04j1g%40group.calendar.google.com&ctz=Etc%2FGMT"
            aria-label="See our calendar"
            class="link-social-calendar">
          <i class="fas fa-calendar fa-lg"></i>
        </a>
      </p>
    </div>
  </div>
  <div class="row">
    <div class="col offset-md-1 text-sm-left footer-licensing" style="text-align: center;">
      Code licensed under <a href="https://github.com/kubevirt/kubevirt/blob/master/LICENSE">Apache 2.0</a>,
      site under <a href="https://github.com/kubevirt/kubevirt.github.io/blob/master/LICENSE">MIT</a>.
    </div>
  </div>
</div>

    </footer>

    <script defer src="https://use.fontawesome.com/releases/v5.1.0/js/all.js" integrity="sha384-3LK/3kTpDE/Pkp8gTNp2gR/2gOiwQ6QaO7Td0zV76UFJVhqLl4Vl3KL1We6q6wR9" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"></script>
    <script id="dsq-count-scr" src="//kubevirt-io.disqus.com/count.js" async></script>
    <script src="/js/kubevirt-io.js"></script>
  </body>
</html>
