<!doctype html>
<html lang="en">

  <head>
    <!-- Adding Adobe Analytics, the google Analytics will be removed after abobe will be well configured -->
    <script id="adobe_dtm" src="//www.redhat.com/dtm.js" type="text/javascript"></script>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1, shrink-to-fit=no" />
    <meta name="go-import" content="kubevirt.io/kubevirt git https://github.com/kubevirt/kubevirt">
    <meta name="description" content="Virtual Machine Management on Kubernetes
">
    <title>Installation</title>

    <link rel="apple-touch-icon" sizes="72x72" href="/assets/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon/favicon-16x16.png">
    <link rel="manifest" href="/assets/favicon/site.webmanifest">
    <link rel="mask-icon" href="/assets/favicon/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#00aba9">
    <meta name="theme-color" content="#ffffff">

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css" integrity="sha384-9gVQ4dYFwwWSjIDZnLEWnxCjeSWFphJiwGPXr1jddIhOegiu1FwO5qRGvFXOdJZ4" crossorigin="anonymous">
    <link rel="stylesheet" href="/css/main.css">
    <link rel="canonical" href="https://www.kubevirt.io//docs/installation">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700" rel="stylesheet">
</head>


  <body>
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top" role="navigation">
        <a class="navbar-brand" href="/">
    <img src="/assets/images/KubeVirt_logo_color.svg" class="navbar-brand-image d-inline-block align-top" alt="KubeVirt.io">
  </a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
    <i class="fas fa-th-large"></i>
  </button>
  <div class="collapse navbar-collapse" id="navbarSupportedContent">
    <ul class="navbar-nav">
      

      
        <li  class="nav-item" >
          <a class="nav-link text-uppercase" href="/blogs/">Blogs</a>
        </li>
      
        <li  class="nav-item" >
          <a class="nav-link text-uppercase" href="/videos/">Videos</a>
        </li>
      
        <li  class="nav-item active" >
          <a class="nav-link text-uppercase" href="https://kubevirt.io/user-guide/#/">Docs</a>
        </li>
      
        <li  class="nav-item" >
          <a class="nav-link text-uppercase" href="/community/">Community</a>
        </li>
      

    </ul>
  </div>

    </nav>

    <main role="main" style="margin-top: 60px;">
      <div class="container">
        <div class="row">
          <h1 class="page-title">Docs</h1>
        </div>
        <div class="row">
          <div class="col-sm-12 col-md-3">
            
  
    
    <ul class="docs-navigation">
      <!-- <h3></h3> -->
      
        <li class="docs-navigation--item">
          <a href="/docs"  class="docs-navigation--item_link" >
            Introduction
          </a>
          
        </li>
      
    </ul>
    
  
    
    <ul class="docs-navigation">
      <!-- <h3></h3> -->
      
        <li class="docs-navigation--item">
          <a href="/docs/installation.html"  class="docs-navigation--item_link active" >
            Installation
          </a>
          
        </li>
      
        <li class="docs-navigation--item">
          <a href="/docs/usage.html"  class="docs-navigation--item_link" >
            Usage
          </a>
          
        </li>
      
        <li class="docs-navigation--item">
          <a href="/docs/authorization.html"  class="docs-navigation--item_link" >
            Authorization
          </a>
          
        </li>
      
        <li class="docs-navigation--item">
          <a href="/docs/workloads.html"  class="docs-navigation--item_link" >
            Workloads
          </a>
          
        </li>
      
        <li class="docs-navigation--item">
          <a href="/docs/additional-resources.html"  class="docs-navigation--item_link" >
            Additional Resources
          </a>
          
        </li>
      
    </ul>
    
  
    
    <ul class="docs-navigation">
      <!-- <h3></h3> -->
      
        <li class="docs-navigation--item">
          <a href="https://kubevirt.io/user-guide/#/"  class="docs-navigation--item_link" >
            User Guide <i class="fas fa-external-link-alt"></i>
          </a>
          
        </li>
      
    </ul>
    
  


          </div>
          <div class="col-sm-12 col-md-9 docs">
            <p>KubeVirt is a virtualization add-on to Kubernetes and this guide assumes that a Kubernetes cluster is already installed.</p>

<h2 id="requirements">Requirements</h2>

<p>A few requirements need to be met before you can begin:</p>

<ul>
  <li><a href="https://kubernetes.io">Kubernetes</a> cluster (<a href="https://github.com/openshift/origin">OpenShift</a>, Tectonic)</li>
  <li><code class="highlighter-rouge">kubectl</code> client utility</li>
  <li><code class="highlighter-rouge">git</code></li>
</ul>

<h3 id="minimum-cluster-requirements">Minimum Cluster Requirements</h3>

<p>Kubernetes 1.10 or later is required to run KubeVirt.</p>

<p>In addition it can be that feature gates need to be opened.</p>

<h4 id="runtime">Runtime</h4>

<p>KubeVirt is currently support on the following container runtimes:</p>

<ul>
  <li>docker</li>
  <li>crio (with runv)</li>
</ul>

<h3 id="virtualization-support">Virtualization support</h3>

<p>There are several distributions of Kubernetes, you need to decide on one and deploy it.</p>

<p>Hardware with virtualization support is recommended. You can use virt-host-validate to ensure that your hosts are capable of running virtualization workloads:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>virt-host-validate qemu
  QEMU: Checking <span class="k">for </span>hardware virtualization                                 : PASS
  QEMU: Checking <span class="k">if </span>device /dev/kvm exists                                   : PASS
  QEMU: Checking <span class="k">if </span>device /dev/kvm is accessible                            : PASS
  QEMU: Checking <span class="k">if </span>device /dev/vhost-net exists                             : PASS
  QEMU: Checking <span class="k">if </span>device /dev/net/tun exists                               : PASS
...
</code></pre></div></div>

<h4 id="software-emulation">Software emulation</h4>

<p>If hardware virtualization is not available, then a <a href="https://github.com/kubevirt/kubevirt/blob/master/docs/software-emulation.md">software emulation fallback</a> can be enabled using:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>kubectl configmap <span class="nt">-n</span> kube-system kubevirt-config <span class="se">\</span>
    <span class="nt">--from-literal</span> debug.allowEmulation<span class="o">=</span><span class="nb">true</span>
</code></pre></div></div>

<p>This ConfigMap needs to be created before deployment or the virt-controller deployment has to be restarted.</p>

<h3 id="hugepages-support">Hugepages support</h3>

<p>For hugepages support you need at least Kubernetes version <code class="highlighter-rouge">1.9</code>.</p>

<h4 id="enable-feature-gate">Enable feature-gate</h4>

<p>To enable hugepages on Kubernetes, check the <a href="https://v1-9.docs.kubernetes.io/docs/tasks/manage-hugepages/scheduling-hugepages/#before-you-begin">official documentation</a>.</p>

<p>To enable hugepages on OpenShift, check the <a href="https://docs.openshift.org/3.9/scaling_performance/managing_hugepages.html#huge-pages-prerequisites">official documentation</a>.</p>

<h4 id="pre-allocate-hugepages-on-a-node">Pre-allocate hugepages on a node</h4>

<p>To pre-allocate hugepages on boot time, you will need to specify hugepages under kernel boot parameters <code class="highlighter-rouge">hugepagesz=2M hugepages=64</code> and restart your machine.</p>

<p>You can find more about hugepages under <a href="https://www.kernel.org/doc/Documentation/vm/hugetlbpage.txt">official documentation</a>.</p>

<h2 id="cluster-side-add-on-deployment">Cluster side add-on deployment</h2>

<h3 id="core-components">Core components</h3>

<p>Once Kubernetes is deployed, you will need to deploy the KubeVirt add-on. The add-on is deployed to a cluster using the <code class="highlighter-rouge">kubectl</code> tool and manifest file:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ RELEASE</span><span class="o">=</span>v0.4.0
<span class="nv">$ </span>kubectl apply <span class="nt">-f</span> https://github.com/kubevirt/kubevirt/releases/download/<span class="k">${</span><span class="nv">RELEASE</span><span class="k">}</span>/kubevirt.yaml
</code></pre></div></div>

<p>This command will deploy the most recent stable version of KubeVirt to your cluster. The new components will be deployed in the <code class="highlighter-rouge">kube-system</code> namespace:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl get pods <span class="nt">-n</span> kube-system
NAME                                           READY     STATUS        RESTARTS   AGE
libvirt-9zmtl                                  2/2       Running       0          28m
virt-controller-5d9fc8cf8b-n5trt               0/1       Running       0          27m
virt-handler-vwdjx                             1/1       Running       0          28m
</code></pre></div></div>

<h2 id="client-side-virtctl-deployment">Client side <code class="highlighter-rouge">virtctl</code> deployment</h2>

<p>Basic VirtualMachineInstance operations can be performed with the stock <code class="highlighter-rouge">kubectl</code> utility. However, the <code class="highlighter-rouge">virtctl</code> binary utility is required to use advanced features such as:</p>

<ul>
  <li>Serial and graphical console access</li>
</ul>

<p>It also provides convenience commands for:</p>

<ul>
  <li>Starting and stopping VirtualMachineInstances</li>
  <li>Live migrating VirtualMachineInstances</li>
</ul>

<p>The most recent version of the tool can be retrieved from the <a href="https://github.com/kubevirt/kubevirt/releases">official release page</a>.</p>

<h2 id="deploying-on-openshift">Deploying on OpenShift</h2>

<p>There are three ways to deploy KubeVirt on OpenShift.</p>

<h3 id="using-command-line-interface">Using command line interface</h3>

<p>The following <a href="https://docs.openshift.com/container-platform/3.7/admin_guide/manage_scc.html">SCCs</a> need to be added prior <code class="highlighter-rouge">kubevirt.yaml</code> deployment:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>oc adm policy add-scc-to-user privileged <span class="nt">-n</span> kube-system <span class="nt">-z</span> kubevirt-privileged
oc adm policy add-scc-to-user privileged <span class="nt">-n</span> kube-system <span class="nt">-z</span> kubevirt-controller
oc adm policy add-scc-to-user privileged <span class="nt">-n</span> kube-system <span class="nt">-z</span> kubevirt-apiserver
</code></pre></div></div>

<p>Once privileges are granted, the <code class="highlighter-rouge">kubevirt.yaml</code> can be deployed:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>kubectl apply <span class="nt">-f</span> https://github.com/kubevirt/kubevirt/releases/download/<span class="k">${</span><span class="nv">RELEASE</span><span class="k">}</span>/kubevirt.yaml
</code></pre></div></div>

<h3 id="from-service-catalog-as-an-apb">From Service Catalog as an APB</h3>

<p>You can find KubeVirt in the OpenShift Service Catalog and install it from there. In order to do that please follow the documentation in the <a href="https://github.com/ansibleplaybookbundle/kubevirt-apb">KubeVirt APB repository</a>.</p>

<h3 id="using-ansible-playbooks">Using Ansible playbooks</h3>

<p>The <a href="https://github.com/kubevirt/kubevirt-ansible">kubevirt-ansible</a> project provides a collection of playbooks that installs KubeVirt and it’s related components on top of OpenShift or Kubernetes clusters.</p>

<h2 id="deploying-from-source">Deploying from Source</h2>

<p>See the <a href="https://github.com/kubevirt/kubevirt/blob/master/docs/getting-started.md">Developer Getting Started Guide</a> to understand how to build and deploy KubeVirt from source.</p>

<h2 id="update">Update</h2>

<blockquote>
  <p>Note: Updates are not yet supported.</p>
</blockquote>

<p>Usually it is sufficient to re-apply the manifests for performing a rolling update:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ RELEASE</span><span class="o">=</span>v0.4.0
<span class="nv">$ </span>kubectl apply <span class="nt">-f</span> https://github.com/kubevirt/kubevirt/releases/download/<span class="k">${</span><span class="nv">RELEASE</span><span class="k">}</span>/kubevirt.yaml
</code></pre></div></div>

<h2 id="additional-installation-steps">Additional Installation Steps</h2>

<ul>
  <li><a href="https://kubevirt.io/user-guide/#/installation/api-validation">Admission Controllers</a></li>
  <li><a href="https://kubevirt.io/user-guide/#/installation/feature-matrix">Feature Matrix</a></li>
</ul>

<hr />

<p>View on <a href="https://kubevirt.io/user-guide/#/installation/README">docs.kubevirt.io</a></p>

          </div>
        </div>
      </div>
    </main>

    <footer class="footer" role="footer">
      <div class="container-fluid">
  <div class="row justify-content-center">
    <div class="col-sm-12 col-md-5">
      <p class="privacy-statement text-sm-left" style="text-align: center;">
        &copy; <script type="text/javascript"> document.write(new Date().getFullYear()); </script> KubeVirt | <a href="/privacy" class="privacy-statement-link">Privacy Statement</a>
      </p>
    </div>
    <div class="col-sm-12 col-md-5" style="text-align: center;">
      <p class="text-md-right">
        <a href="https://twitter.com/kubevirt" aria-label="Visit us on Twitter" class="link-social-twitter">
          <i class="fab fa-twitter fa-lg"></i>
        </a>
        <a href="https://github.com/kubevirt" aria-label="View our repo on GitHub" class="link-social-github">
          <i class="fab fa-github fa-lg"></i>
        </a>
        <a href="https://groups.google.com/forum/#!forum/kubevirt-dev" aria-label="Send us an email" class="link-social-mail">
          <i class="fas fa-envelope fa-lg"></i>
        </a>
        <a href="https://calendar.google.com/calendar/embed?src=18pc0jur01k8f2cccvn5j04j1g%40group.calendar.google.com&ctz=Etc%2FGMT"
            aria-label="See our calendar"
            class="link-social-calendar">
          <i class="fas fa-calendar fa-lg"></i>
        </a>
      </p>
    </div>
  </div>
  <div class="row">
    <div class="col offset-md-1 text-sm-left footer-licensing" style="text-align: center;">
      Code licensed under <a href="https://github.com/kubevirt/kubevirt/blob/master/LICENSE">Apache 2.0</a>,
      site under <a href="https://github.com/kubevirt/kubevirt.github.io/blob/master/LICENSE">MIT</a>.
    </div>
  </div>
</div>

    </footer>

    <script defer src="https://use.fontawesome.com/releases/v5.1.0/js/all.js" integrity="sha384-3LK/3kTpDE/Pkp8gTNp2gR/2gOiwQ6QaO7Td0zV76UFJVhqLl4Vl3KL1We6q6wR9" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.0/umd/popper.min.js" integrity="sha384-cs/chFZiN24E4KMATLdqdvsezGxaGsi4hLGOzlXwp5UZB1LY//20VyM2taTB4QvJ" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/js/bootstrap.min.js" integrity="sha384-uefMccjFJAIv6A+rW+L4AHf99KvxDjWSu1z9VI8SKNVmz4sk7buKt/6v9KI65qnm" crossorigin="anonymous"></script>
    <script id="dsq-count-scr" src="//kubevirt-io.disqus.com/count.js" async></script>
    <script src="/js/kubevirt-io.js"></script>
    <script type="text/javascript">
        if (("undefined" !== typeof _satellite) && ("function" === typeof _satellite.pageBottom)) {
            _satellite.pageBottom();
        }
    </script>
  </body>
</html>
